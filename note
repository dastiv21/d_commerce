from rest_framework.exceptions import PermissionDenied
from rest_framework import status

def custom_authentication_check(request):
    if not request.user.is_authenticated:
        raise PermissionDenied(detail="Authentication failed.", code=status.HTTP_401_UNAUTHORIZED)

def custom_permission_check(request):
    if not request.user.has_perm('can_view_product'):
        raise PermissionDenied(detail="Permission denied.", code=status.HTTP_403_FORBIDDEN)